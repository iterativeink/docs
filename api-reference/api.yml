openapi: 3.1.0
info:
  title: Pulsedive API Reference
  version: "1.0.0"
  description: |
    The Pulsedive API lets you programmatically manage resources within Pulsedive.
    Users can look up known indicators and threats, enrich and investigate indicators, query Pulsedive data, and automate workflows.
    If an API key is provided, the rate limit is higher.

    Please report any discrepancies in API behavior to <a href="mailto:support@pulsedive.com">Pulsedive Support</a>.
  license:
    name: Apache 2.0
    url: https://www.apache.org/licenses/LICENSE-2.0.html
  contact:
    email: support@pulsedive.com

externalDocs:
  url: https://pulsedive.mintlify.app

servers:
  - url: https://www.pulsedive.com

tags:
  - name: Indicators
    description: Look up known indicators.
  - name: Threats
    description: Look up known threats.

paths:
  /api/info.php:
    get:
      security:
        - ApiKeyAuth: [] # Optional authentication
      tags:
        - Indicators
      summary: Get Indicator By Value
      description: |
        Retrieve detailed threat intelligence information for a specific indicator by value.
        To query links and properties, retrieve the indicator by ID instead.
      operationId: getIndicatorByValue
  
      parameters:
        - name: indicator
          in: query
          required: true
          description: Value of the indicator to retrieve. May be a domain name, IP address, or URL.
          oneOf:
            - type: string
              format: ipv4
            - type: string
              format: hostname
            - type: string
              format: uri
          examples:
            ip:
              summary: IPv4 address
              value: 8.8.8.8
            domain:
              summary: Domain name
              value: microsoft.com
            url:
              summary: URL
              value: https://puledive.com/explore
        - name: pretty
          in: query
          required: false
          description: Indicates whether to format returned JSON results.
          schema:
            type: integer
            enum: [0, 1]
            default: 0
          examples:
            compact:
              summary: Compact output
              value: 0
            pretty:
              summary: Pretty-printed output
              value: 1

      responses:
        '200':
          description: Request was successful. Returns indicator information in JSON format.

components:
  schemas:

  securitySchemes:
    ApiKeyAuth:
      type: apiKey
      in: query
      name: key
